openapi: 3.0.1
info:
  title: auth-service
  version: 1.0.0
paths:
  /api/v1/auth/change-password:
    post:
      tags:
      - Auth API
      summary: Change password
      operationId: changePassword
      requestBody:
        content:
          application/json:
            schema:
              $ref: "#/components/schemas/ChangePasswordRequest"
        required: true
      responses:
        "204":
          description: Password changed
        "200":
          description: changePassword 200 response
          content:
            application/json:
              schema:
                type: string
  /api/v1/auth/login:
    post:
      tags:
      - Auth API
      summary: Login
      operationId: login
      requestBody:
        content:
          application/json:
            schema:
              $ref: "#/components/schemas/LoginRequest"
        required: true
      responses:
        "200":
          description: Authenticated
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/AuthResponse"
  /api/v1/auth/logout:
    post:
      tags:
      - Auth API
      summary: Logout (clear refresh cookie)
      operationId: logout
      responses:
        "204":
          description: Logged out
        "200":
          description: logout 200 response
          content:
            application/json:
              schema:
                type: object
  /api/v1/auth/refresh:
    post:
      tags:
      - Auth API
      summary: Refresh token via cookie
      operationId: refresh
      responses:
        "200":
          description: Tokens refreshed
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/AuthResponse"
  /api/v1/auth/register:
    post:
      tags:
      - Auth API
      summary: Register user
      operationId: register
      requestBody:
        content:
          application/json:
            schema:
              $ref: "#/components/schemas/RegisterRequest"
        required: true
      responses:
        "201":
          description: User created
        "200":
          description: register 200 response
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/UserDto"
components:
  schemas:
    AuthResponse:
      required:
      - accessToken
      - expiresInMs
      - refreshToken
      type: object
      properties:
        accessToken:
          type: string
        refreshToken:
          type: string
        expiresInMs:
          type: integer
          format: int64
    ChangePasswordRequest:
      required:
      - newPassword
      - oldPassword
      type: object
      properties:
        oldPassword:
          type: string
        newPassword:
          type: string
    LoginRequest:
      required:
      - password
      - username
      type: object
      properties:
        username:
          type: string
        password:
          type: string
    RegisterRequest:
      required:
      - password
      - username
      type: object
      properties:
        username:
          type: string
        password:
          type: string
    UserDto:
      required:
      - id
      - username
      type: object
      properties:
        id:
          type: integer
          format: int64
        username:
          type: string
